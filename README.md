# Diplom_My_cloud
Дипломный проект по профессии «Fullstack-разработчик на Python»

Запуск

Создайте виртуальное окружение
(В программе VSCode комбинация клавиш Ctrl+Shirft+P. В строке поиска наберите 
Python: Create Environment и выберите "Venv Creates .venv virtual environments in current workspace
Появится предложение сразу же установить зависимости из файла requirements.txt в виртуальное окружение,
соглашаемся и шаг с установкой зависимостей можно пропустить
)

python -m venv .venv

Активируйте его
.venv/Scripts/activate

Установите зависимости
pip install -r requirements.txt

либо используйте (установите при необходимости) pipenv
pip install pipenv

и установите зависимости из файла Pipfile
pipenv install

Далее создаем файл .env со следующим содержимым:

SECRET_KEY=*******  генерируем с помощью терминала 
>python: 
>>> import secrets 
>>> print(secrets.token_urlsafe(50))
Копируем и вставляем вместо *** после SECRET_KEY= 
ALLOWED_HOSTS= localhost,127.0.0.1,ИМЯ ДОМЕНА ИЛИ IP АДРЕС СЕРВЕРА
DB_NAME=Название вашей БД
DB_USER=имя пользователя БД
DB_PASSWORD=пароль пользователя БД
DB_HOST=localhost
DB_PORT=5432

Создайте БД в PgAdmin4 или в терминале
createdb -U <DB_USER> <DB_NAME>

Выполните миграции БД
python manage.py migrate

Создайте суперпользователя для админки Django (Для входа в админ-панель)
python manage.py createsuperuser
либо по готову скрипту с подставленными по умолчанию параметрами командой находясь в папке my_cloud
>python manage.py create_admin
Администратор создан:
Username: admin
Email: admin@mycloud.com
Password: Admin123!
Storage path: user_admin

Перед данной командой можно в файле по относительному пути в в файле mycloud/users/management/commands/create_admin.py изменить параметры создания ползователя на свои.

Запустите сервер Django
python manage.py runserver

Админка доступна по адресу
http://127.0.0.1:8000/admin/

-----------------------------------------------------
Запуск FRONTEND
Создаем второй терминал не останавливая терминал django
Переходим в терминале в папку frontend (если вы находитесь в папке mycloud тогда командой >cd frontend)
Устанвливаем все зависимости из файла package.json
>npm install

Запускаем React командой 
>npm start

P.S. Иногда, по непонятным причинам бывет глюк с Chakra. Выдает ошибки что не может найти какой-либо компонент или хук в модуле chakra-ui/react...При анализе оказалось, что данные компоненты действительно отсутствуют в системе.
Нашел пока такой костыль
>npm i @chakra-ui/react@2 @emotion/react @emotion/styled framer-motion

Открыть браузер
  Local:            http://localhost:3000        
  On Your Network:  http://172.27.176.1:3000  


Что сделано...
Установлены Django и React
Установка и подключение БД PostgreSQL mycloud_db
Скрестил Django и React на одном порту.
Создал первичные тестовые модели "Пользователи" и "Файлы". Связь один-ко-многим.
Добавил папку storage, в нее добавляются файлы пользователей, при создании через админку
Создал шаблон и натянул bootstrap для лучшей наглядности записей.
Добавление навигационной панели.
Настройка роутинга между страницами списка файлов и какого-то конкретного
Создание приложения для работы с REST API. Используется фреймворк django-tastypie
Для работы с POST-запросами делаем аутентификацию и авторизацию пользователей.
...
После штудирования инета все-таки вернулся к авторизации на JWT-токены как более надежные и современные. Все работает
Убрал конфиденциальные данные в файл .env
Добавил скрипт создания админа с готовыми полями.
Все-таки решил создать пользовательское поле is_admin вместо встроенных в Django 5.0 is_staff и is_superadmin, как было сказано в задании, во избежание препеисывания большого куска кода в дальнейшем, если все-таки потребуют его наличие.
Провел успешные тесты через POSTMAN:
-регистрация пользователя
-получение данных юзера
-получение его файлов
-добваление файла
-получение файла по публичной ссылке (без авторизации)
-получение файла приватно
От имени админа тесты:
-получение списка всех пользователей
-получение всех файлов пользователя
-удаление файла по id
-удаление пользователя по id (удаляется и его хранилище файлов)
-изменение прав пользователя
------------------
БЕКЕНД НАСТРОЕН!!!
На фронте переделал логику приложения. Переделал и вынес в отдельные компоненты: админки, авторизации, работа с хранилищем, навигация. Вынес логику запросов к Django API и работу с JWT-токенами Добавил защищенные маршруты

Frontend вроде как готов, тестировал, с каких-то дел Chakra отвалилась...либо у них произошел регресс и нужно переписывать все стили на Tailwind или что-то подобное, либо подождать обнову от них с денек...либо что-то я сломал...

Chakra win! Почему-то нужно доустановить компоненты и хуки командой npm i @chakra-ui/react@2 @emotion/react @emotion/styled framer-motion
--------------------
FRONTEND НАСТРОЕН!!!
Тесты и исправления внесены.
Осталось только задеплоить на хостинге.
К сожалению проект начал делать сразу на JS, думаю что позже перепишу его на TS. Сейчас уже кардинально все переписывать нет смысла, да и нет времени. На будущее нужно проекты сразу писать на TS.


------
TODO
Добавить свою 404
Возможно изменить логику отображения вместо файлов -> пользователи и переход не к файлу, а к пользователю с его файлами?
API - POST - запросы либо через APIKey  в админке, либо через поле is_admin модели USER
